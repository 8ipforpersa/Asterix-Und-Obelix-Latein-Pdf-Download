[Unit]
Description=Polymarch worker Service
After=network.target remote-fs.target nss-lookup.target

[Service]
Type=forking
ExecStart=/opt/polemarch/bin/celery multi start worker -A polymarch.celery_app:app \
                                  -B -f /var/log/polymarch/worker.log -l WARNING \
                                  --pidfile=/var/run/polymarch/worker.pid \
                                  --schedule=/var/run/polymarch/beat-schedule
ExecReload=/opt/polemarch/bin/celery multi restart worker -A polymarch.celery_app:app \
                                   -B -f /var/log/polymarch/worker.log -l WARNING \
                                   --pidfile=/var/run/polymarch/worker.pid \
                                   --schedule=/var/run/polymarch/beat-schedule
ExecStop=/opt/polemarch/bin/celery multi stopwait worker -A polymarch.celery_app:app \
                                 -B -f /var/log/polymarch/worker.log -l WARNING \
                                 --pidfile=/var/run/polymarch/worker.pid \
                                 --schedule=/var/run/polymarch/beat-schedule
PIDFile=/var/run/polemarch/worker.pid
User=polemarch
Group=polemarch
KillSignal=SIGCONT
Restart=always

[Install]
WantedBy=multi-user.target
